@model Projeto.Restaurante.MVC.ViewModels.Pedido.ViewModelEditPedido
@{
    ViewBag.Title = "Alterar";
}

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    <div class="panel panel-primary">
        <div class="panel-heading">
            Cadastrar
        </div>
        <div class="panel-body">
            @Html.ValidationSummary(true, "", new { @class = "text-danger" })
            <div class="form-group">
                <label class="control-label col-md-2">
                    @Html.DisplayNameFor(model => model.Id)
                </label>
                <div class="col-md-10">
                    @Html.DisplayFor(model => model.Id)
                </div>
            </div>

            <div class="form-group">
                @Html.LabelFor(model => model.Ativo, new { @class = "control-label col-md-2" })
                <div class="col-md-10">
                    <div>
                        @Html.EditorFor(model => model.Ativo)
                        @Html.ValidationMessageFor(model => model.Ativo, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>

            <div class="form-group">
                @Html.LabelFor(model => model.Mesas, new { @class = "control-label col-md-2" })
                <div class="col-md-10">
                    <div>
                        @{
    var mesas = Model.Mesas.Select(x => new SelectListItem { Value = x.Id.ToString(), Text = x.Nome }).ToList();
                        }
                        @Html.DropDownList("MesaId", mesas, new { @class = "form-control" })
                        @Html.ValidationMessageFor(model => model.MesaId, "", new { @class = "text-danger" })
                    </div>
                </div>
            </div>

            <div class="panel panel-info">
                <div class="panel-heading">
                    Itens
                </div>
                <div class="panel-body">

                    <div class="form-group">
                        <div class="col-md-12">
                            <input id="btnNovoItem" type="button" value="Novo" class="btn btn-info" />
                        </div>
                    </div>

                    <div id="divItem">

                        <div class="form-group">
                            @Html.LabelFor(model => model.Pratos, new { @class = "control-label col-md-2" })
                            <div class="col-md-4">
                                <div>
                                    @{
    var pratos = Model.Pratos.Select(x => new SelectListItem
    {
        Value = x.Id.ToString(),
        Text = x.Nome + " - " + x.Preco
        ,
        Group = new SelectListGroup { Name = x.Categoria.Nome }
    }).ToList();
                                    }
                                    @Html.DropDownList("PratoId", pratos, new { @class = "form-control" })
                                    @Html.ValidationMessageFor(model => model.MesaId, "", new { @class = "text-danger" })
                                </div>
                            </div>

                            @Html.LabelFor(model => model.Opcoes, new { @class = "control-label col-md-2" })
                            <div class="col-md-4">
                                <div>
                                    @{
    var opcoes = Model.Opcoes.Select(x => new SelectListItem { Value = x.Id.ToString(), Text = x.Nome }).ToList();
                                    }
                                    @Html.DropDownList("OpcaoId", opcoes, new { @class = "form-control" })
                                    @Html.ValidationMessageFor(model => model.MesaId, "", new { @class = "text-danger" })
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <div class="col-md-offset-4 col-md-2">
                                <input id="btnAssociarItem" type="button" value="Associar Item" class="btn btn-info" />
                            </div>
                            <div class="col-md-2">
                                <input id="btnFinalizarItem" type="button" value="Finalizar Item" class="btn btn-info" />
                            </div>
                        </div>

                    </div>

                </div>

            </div>

            <div class="form-group">
                <div class="col-md-offset-6 col-md-6">
                    <input type="submit" value="Alterar" class="btn btn-info" />
                </div>
            </div>
        </div>
    </div>
}

<div class="form-group">
    <div class="col-md-2">
        @Html.ActionLink("Listar", "Index", null, null, new { @class = "btn btn-info btn-block" })
    </div>
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
    <script type="text/javascript">
        $(document).ready(function () {
            $("#divItem").hide();
            $("#btnNovoItem").show();

            $("#btnNovoItem").click(function () {
                $("#divItem").show();
                $("#btnNovoItem").hide();
            });

            $("#btnAssociarItem").click(function () {
                $("#PratoId").attr("disabled", "disabled");
            });

            $("#btnFinalizarItem").click(function () {
                $("#divItem").hide();
                $("#btnNovoItem").show();
                $("#PratoId").removeAttr("disabled");
            });

        });
    </script>
}
